import{c as e,l as t}from"./lib.js";import{H as r,D as s,h as i,F as n,b as o,S as a,c as g,f as d,g as l,C as u}from"./lspLanguageFeatures.js";import{a as h,e as m,d as c,R as p,i as w,j as v,t as _,k}from"./lspLanguageFeatures.js";class f{constructor(e){this._defaults=e,this._worker=null,this._client=null,this._idleCheckInterval=window.setInterval(()=>this._checkIfIdle(),3e4),this._lastUsedTime=0,this._configChangeListener=this._defaults.onDidChange(()=>this._stopWorker())}_stopWorker(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null}dispose(){clearInterval(this._idleCheckInterval),this._configChangeListener.dispose(),this._stopWorker()}_checkIfIdle(){this._worker&&Date.now()-this._lastUsedTime>12e4&&this._stopWorker()}_getClient(){return this._lastUsedTime=Date.now(),this._client||(this._worker=e({moduleId:"vs/language/html/htmlWorker",createWorker:()=>new Worker(new URL(""+new URL("html.worker-B51mlPHg.js",import.meta.url).href,import.meta.url),{type:"module"}),createData:{languageSettings:this._defaults.options,languageId:this._defaults.languageId},label:this._defaults.languageId}),this._client=this._worker.getProxy()),this._client}getLanguageServiceWorker(...e){let t;return this._getClient().then(e=>{t=e}).then(t=>{if(this._worker)return this._worker.withSyncedResources(e)}).then(e=>t)}}class P extends u{constructor(e){super(e,[".",":","<",'"',"=","/"])}}function R(e){const u=new f(e),h=(...e)=>u.getLanguageServiceWorker(...e);let m=e.languageId;t.registerCompletionItemProvider(m,new P(h)),t.registerHoverProvider(m,new r(h)),t.registerDocumentHighlightProvider(m,new s(h)),t.registerLinkProvider(m,new i(h)),t.registerFoldingRangeProvider(m,new n(h)),t.registerDocumentSymbolProvider(m,new o(h)),t.registerSelectionRangeProvider(m,new a(h)),t.registerRenameProvider(m,new g(h)),"html"===m&&(t.registerDocumentFormattingEditProvider(m,new d(h)),t.registerDocumentRangeFormattingEditProvider(m,new l(h)))}function D(e){const u=[],h=[],m=new f(e);u.push(m);const c=(...e)=>m.getLanguageServiceWorker(...e);return function(){const{languageId:u,modeConfiguration:m}=e;F(h),m.completionItems&&h.push(t.registerCompletionItemProvider(u,new P(c))),m.hovers&&h.push(t.registerHoverProvider(u,new r(c))),m.documentHighlights&&h.push(t.registerDocumentHighlightProvider(u,new s(c))),m.links&&h.push(t.registerLinkProvider(u,new i(c))),m.documentSymbols&&h.push(t.registerDocumentSymbolProvider(u,new o(c))),m.rename&&h.push(t.registerRenameProvider(u,new g(c))),m.foldingRanges&&h.push(t.registerFoldingRangeProvider(u,new n(c))),m.selectionRanges&&h.push(t.registerSelectionRangeProvider(u,new a(c))),m.documentFormattingEdits&&h.push(t.registerDocumentFormattingEditProvider(u,new d(c))),m.documentRangeFormattingEdits&&h.push(t.registerDocumentRangeFormattingEditProvider(u,new l(c)))}(),u.push(I(h)),I(u)}function I(e){return{dispose:()=>F(e)}}function F(e){for(;e.length;)e.pop().dispose()}export{u as CompletionAdapter,h as DefinitionAdapter,m as DiagnosticsAdapter,c as DocumentColorAdapter,d as DocumentFormattingEditProvider,s as DocumentHighlightAdapter,i as DocumentLinkAdapter,l as DocumentRangeFormattingEditProvider,o as DocumentSymbolAdapter,n as FoldingRangeAdapter,r as HoverAdapter,p as ReferenceAdapter,g as RenameAdapter,a as SelectionRangeAdapter,f as WorkerManager,w as fromPosition,v as fromRange,D as setupMode,R as setupMode1,_ as toRange,k as toTextEdit};
