const holder={};async function translate(t,e,n){return holder.mstranslate(t,e,n)}(()=>{var cr=cr||{};cr.googleTranslate=function(){const ERROR={NONE:0,TRANSLATION_ERROR:6,UNEXPECTED_SCRIPT_ERROR:8,BAD_ORIGIN:9,SCRIPT_LOAD_ERROR:10},EDGE_SCRIPT_RESULT={SUCCESSFUL:0,TIMEOUT:1,BAD_REQUEST:2,SERVICE_UNAVAILABLE:3,SERVICE_ERROR:4,NETWORK:5,UNKNOWN:6,SCRIPT_TIMEOUT:7},BAD_REQUEST_ERROR={OTHERS:0,INVALID_INPUT:1,INVALID_CREDENTIALS:2,TOO_MANY_REQUESTS:3};let errorCode=ERROR.NONE,edgeScriptResult=EDGE_SCRIPT_RESULT.SUCCESSFUL,languageDetectionResults=[],badRequestError=BAD_REQUEST_ERROR.OTHERS,finished=!1,revertCompleted=!1;const injectedTime=performance.now(),readyTime=0;let startTime=0,endTime=0,totalTranslatedCharactersSoFar=0,totalCharactersTranslatedByRetry=0,translateCallCount=0,translateServiceSubscriptionKey=null;const kChromeCodeToEdgeCode={"zh-CN":"zh-CHS","zh-TW":"zh-CHT"},kEdgeCodeToChromeCode={"zh-chs":"zh-CN","zh-cht":"zh-TW",pt:"pt-BR","pt-pt":"pt-PT","sr-Latn":"sr-Latn-RS","zh-hans":"zh-CN","zh-hant":"zh-TW"},kLanguageNotDetectedCode="",SCRIPT_CUSTOM_STATUS_CODE={NETWORK_TIMEOUT:-1,SCRIPT_TIMEOUT:-2};function isBadRequest(t){return null!=t.status&&t.status>=400&&t.status<500}function classifyBadRequestError(t){switch(t){case 400:return BAD_REQUEST_ERROR.INVALID_INPUT;case 401:return BAD_REQUEST_ERROR.INVALID_CREDENTIALS;case 429:return BAD_REQUEST_ERROR.TOO_MANY_REQUESTS;default:return BAD_REQUEST_ERROR.OTHERS}}function isServiceUnavailable(t){return null!=t.status&&503===t.status}function isServerError(t){return null!=t.status&&t.status>=500&&t.status<600}function GetEdgeLanguageCode(t){return t in kChromeCodeToEdgeCode?kChromeCodeToEdgeCode[t]:t}function GetChromeLanguageCode(t){return t in kEdgeCodeToChromeCode?kEdgeCodeToChromeCode[t]:t}function invokeResultCallback(){cr.googleTranslate.resultCallback&&(cr.googleTranslate.resultCallback(),cr.googleTranslate.resultCallback=null)}function onSuccessCallback(){finished=!0,endTime=performance.now(),invokeResultCallback(),updateLanguageDetectionResults()}function updateLanguageDetectionResults(){const t=Microsoft?.Translator?.getAllDetectedLanguages?.();if(t){const e=Object.entries(t);e.sort(([t,e],[n,s])=>s-e);const n=e.reduce((t,[e,n])=>t+n,0);languageDetectionResults=0===n?[]:e.map(([t,e])=>[GetChromeLanguageCode(t),e/n*100])}}function onTranslateApiCalled(t,e){e&&(totalCharactersTranslatedByRetry+=t),totalTranslatedCharactersSoFar+=t,translateCallCount++}function onErrorCallback(t){errorCode=ERROR.TRANSLATION_ERROR;try{const e=JSON.parse(t);e.status===SCRIPT_CUSTOM_STATUS_CODE.SCRIPT_TIMEOUT?edgeScriptResult=EDGE_SCRIPT_RESULT.SCRIPT_TIMEOUT:e.status===SCRIPT_CUSTOM_STATUS_CODE.NETWORK_TIMEOUT?edgeScriptResult=EDGE_SCRIPT_RESULT.TIMEOUT:isBadRequest(e)?(edgeScriptResult=EDGE_SCRIPT_RESULT.BAD_REQUEST,badRequestError=classifyBadRequestError(e.status)):isServiceUnavailable(e)?edgeScriptResult=EDGE_SCRIPT_RESULT.SERVICE_UNAVAILABLE:isServerError(e)?edgeScriptResult=EDGE_SCRIPT_RESULT.SERVICE_ERROR:0===e.status&&(edgeScriptResult=EDGE_SCRIPT_RESULT.NETWORK)}catch{edgeScriptResult=EDGE_SCRIPT_RESULT.UNKNOWN}finished=!1,invokeResultCallback()}function translateInternal(t,e,n){resetDataBeforeTranslateCall();try{t=GetEdgeLanguageCode(t),e=GetEdgeLanguageCode(e),null!=translateServiceSubscriptionKey&&""!=translateServiceSubscriptionKey&&Microsoft.Translator.setTranslateServiceSubscriptionKey(translateServiceSubscriptionKey),Microsoft.Translator.startPageTranslation(t,e,n,onSuccessCallback,onTranslateApiCalled,onErrorCallback),console.info("Edge Translation started")}catch(t){return console.error("Translate: "+t),errorCode=ERROR.UNEXPECTED_SCRIPT_ERROR,!1}return!0}function resetDataBeforeTranslateCall(){finished=!1,revertCompleted=!1,errorCode=ERROR.NONE,startTime=performance.now(),totalTranslatedCharactersSoFar=0,totalCharactersTranslatedByRetry=0,translateCallCount=0}return{get finished(){return finished},get revertCompleted(){return revertCompleted},get error(){return errorCode!==ERROR.NONE},get errorCode(){return errorCode},get sourceLang(){const t=Microsoft?.Translator?.getDetectedLanguage?.();return t&&errorCode==ERROR.NONE?GetChromeLanguageCode(t):kLanguageNotDetectedCode},sourceLangDetectedAt:t=>t!==parseInt(t,10)||t<0||t>=languageDetectionResults.length?"":languageDetectionResults[t][0],sourceLangDetectionPercentAt:t=>t!==parseInt(t,10)||t<0||t>=languageDetectionResults.length?0:languageDetectionResults[t][1],get edgeScriptResult(){return edgeScriptResult},get badRequestError(){return badRequestError},get loadTime(){return 0},get readyTime(){return readyTime-injectedTime},get translationTime(){return finished?endTime-startTime:0},get totalTranslatedCharactersSoFar(){return totalTranslatedCharactersSoFar},get totalCharactersTranslatedByRetry(){return totalCharactersTranslatedByRetry},get translateCallCount(){return translateCallCount},setTranslationServiceKey(t){null!=t&&""!=t&&(translateServiceSubscriptionKey=t)},get isCodeTagPresentOnPage(){return 0!=document.querySelectorAll("code").length},translate:(t,e)=>translateInternal(t,e,!1),translateFullPageInOneGo:(t,e)=>translateInternal(t,e,!0),translateSelection(t){resetDataBeforeTranslateCall();try{t=GetEdgeLanguageCode(t),null!=translateServiceSubscriptionKey&&""!=translateServiceSubscriptionKey&&Microsoft.Translator.setTranslateServiceSubscriptionKey(translateServiceSubscriptionKey),Microsoft.Translator.startSelectionTranslation(t,onSuccessCallback,onTranslateApiCalled,onErrorCallback)}catch(t){return console.error("Translate Selection: "+t),errorCode=ERROR.UNEXPECTED_SCRIPT_ERROR,!1}return!0},revert(){Microsoft.Translator.stopPageTranslation().then(()=>{revertCompleted=!0,console.info("Edge revert page translation.")})},onTranslateElementError(t){errorCode=ERROR.UNEXPECTED_SCRIPT_ERROR},onLoadCSS(t){const e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.charset="UTF-8",e.href=t,document.head.appendChild(e)},onLoadJavascript(url){if(!url.startsWith(securityOrigin))return console.error("Translate: "+url+" is not allowed to load."),void(errorCode=ERROR.BAD_ORIGIN);const xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.onreadystatechange=function(){if(this.readyState===this.DONE){if(200!==this.status)return void(errorCode=ERROR.SCRIPT_LOAD_ERROR);eval(this.responseText)}},xhr.send()}}}();try{var Microsoft;(()=>{var t,e,n={d:(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},s={};n.r(s),n.d(s,{Translator:()=>Pt}),(e=t||(t={}))[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=4]="Info",e[e.Debug=8]="Debug",e[e.Assert=16]="Assert",e[e.All=4294967295]="All";let r=null,o=0;function i(t,e){let n;try{n=JSON.parse(t.responseText)}catch{throw new Ut(t.responseText)}if(xt(n)!==e)throw new Ut(Mt(n));return n}class a{constructor(t,e,n){if(this.authorizationUrl=t,this.translationUrl=e,this.issueTokenUrl=n,null==t||0===t.length||null==e||0===e.length||null==n||0===n.length)throw new Error("The URL can not be empty")}getAuthorizationTokenAsync(){return function(){if(null==r||0==o)return!1;const t=((new Date).getTime()-o)/6e4;return Math.round(t)<=8}()?Promise.resolve(r):(o=(new Date).getTime(),null!=this.translateServiceSubscriptionKey&&""!=this.translateServiceSubscriptionKey?Ht(It.POST,this.issueTokenUrl,{headers:{"Ocp-Apim-Subscription-Key":this.translateServiceSubscriptionKey,"Content-Type":"application/x-www-form-urlencoded"}}):Ht(It.GET,this.authorizationUrl,{}))}asyncFetchHelper(t,e,n,s,o,a){if(null==e||0===e.length)return Promise.reject(new Ut("toLang cannot be null or empty"));if(null==n)return Promise.reject(new Ut("Must specify an array of text items to translate"));r=s;const l={from:t||"",to:e};let u;l["api-version"]="3.0",l.includeSentenceLength="true";let h=0;const c=[];for(u=0;u<n.length;++u)c.push({Text:n[u]}),h+=n[u].length;o(h,a);const d="Bearer "+s;return Ht(It.POST,this.translationUrl,{query:l,contentType:"application/json",body:JSON.stringify(c),headers:{Authorization:d},parser(e){const n=i(e,"array"),s=[];for(let e=0;n.length&&e<n.length;e++){const r=n[e];s.push({From:t||r.detectedLanguage?.language,TranslatedText:r.translations[0].text,OriginalTextSentenceLengths:r.translations[0]?.sentLen?.srcSentLen??0,TranslatedTextSentenceLengths:r.translations[0]?.sentLen?.transSentLen??0})}return s}})}translateAsync(t,e,n,s){return this.getAuthorizationTokenAsync().then(r=>r?this.translateAsyncHelper(t,e,n,r,a.NETWORK_ATTEMPTS,s,!1):Promise.reject("Invalid auth token")).catch(t=>Promise.reject(t))}translateAsyncHelper(t,e,n,s,r,o,i){return this.asyncFetchHelper(t,e,n,s,o,i).then(t=>t).catch(i=>1===r||0!==i.status?Promise.reject(i):this.translateAsyncHelper(t,e,n,s,r-1,o,!0))}}a.NETWORK_ATTEMPTS=5,a.TEXT_CONTENT="text/plain",a.XML_CONTENT="text/xml",a.HTML_CONTENT="text/html";class l{constructor(t){if(this.translationUrl=t,null==t||0===t.length)throw new Error("The URL can not be empty")}translateAsync(t,e,n,s){if(null==e||0===e.length)return Promise.reject(new Ut("toLang cannot be null or empty"));if(null==n)return Promise.reject(new Ut("Must specify an array of text items to translate"));const r={from:t||"",to:e,"api-version":"3.0",includeSentenceLength:"true"};let o=0;return n.forEach(t=>{o+=t.length}),s(o,!1),Ht(It.POST,this.translationUrl,{query:r,contentType:"application/json",body:JSON.stringify(n),parser(e){const n=i(e,"array"),s=[];for(let e=0;n.length&&e<n.length;e++){const r=n[e];s.push({From:t||r.detectedLanguage?.language,TranslatedText:r.translations[0].text,OriginalTextSentenceLengths:r.translations[0]?.sentLen?.srcSentLen??0,TranslatedTextSentenceLengths:r.translations[0]?.sentLen?.transSentLen??0})}return s}})}}class u{getAuthorizationTokenAsync(){return Promise.resolve("null")}translateAsync(t,e,n,s){if(null==e||0===e.length)return Promise.reject(new Ut("toLang cannot be null or empty"));if(null==n)return Promise.reject(new Ut("Must specify an array of text items to translate"));""==t&&(t=e);let r=0;n.forEach(t=>{r+=t.length}),s(r,!1);const o=[];for(const s of n)if(window.mockApiMap[s]&&window.mockApiMap[s][e]){const n=window.mockApiMap[s][e];o.push({TranslatedText:n,From:t,OriginalTextSentenceLengths:s.split(".").map(t=>t.length),TranslatedTextSentenceLengths:n.split(".").map(t=>t.length)})}else h.error("Could not translate: "+s+" from "+t+" to "+e),o.push({From:t,Error:"MockAPI does not has a translation for "+s+" to convert in "+e,OriginalTextSentenceLengths:s.split(".").map(t=>t.length),TranslatedTextSentenceLengths:[0],TranslatedText:""});return Promise.resolve(o)}}const h={info(...e){c.logLevel&t.Info&&console.info(...e)},warning(...e){c.logLevel&t.Warning&&console.warn(...e)},error(...e){c.logLevel&t.Error&&console.error(...e)},assert(e,...n){c.logLevel&t.Debug&&(n.unshift(e),console.assert(e,...n))},debug(...e){c.logLevel&t.Debug&&console.debug(...e)}},c={logLevel:t.Error,debug:!1};let d=new a("https://edge.microsoft.com/translate/auth","https://api.cognitive.microsofttranslator.com/translate","https://api.cognitive.microsoft.com/sts/v1.0/issueToken");const g={translationStartTime:0,requestsInitiated:!1};let p;function m(t){p=t}function T(t){return Object.freeze(new Map(Object.entries(t)))}function f(t){return Object.freeze(t)}(()=>{let t;switch((e=t||(t={}))[e.AzureAPIV3=2]="AzureAPIV3",e[e.EdgeTranslateAPI=3]="EdgeTranslateAPI",e[e.TranslateTestAPI=4]="TranslateTestAPI",2){case t.AzureAPIV3:h.debug("Using Translate V3 APIs"),d=new a("https://edge.microsoft.com/translate/auth","https://api.cognitive.microsofttranslator.com/translate","https://api.cognitive.microsoft.com/sts/v1.0/issueToken");break;case t.EdgeTranslateAPI:h.debug("Using Edge Translate APIs"),d=new l("https://edge.microsoft.com/translate/");break;case t.TranslateTestAPI:h.debug("Using Translate Test Client"),d=new u;break;default:h.debug("Incorrect translate version passed from CPP !")}var e})(),holder.mstranslate=async(t,e,n)=>await d.translateAsync(t,e,n,()=>{});const E=T({head:1,script:1,style:1,code:1,samp:1,var:1,kbd:1,pre:1,object:1,address:1,noscript:1,embed:1,map:1}),b=T({textarea:1});var _;!function(t){t[t.Inherit=0]="Inherit",t[t.On=1]="On",t[t.Off=2]="Off",t[t.Skip=3]="Skip"}(_||(_={}));const S=Object.assign(T({hr:1,input:1,title:1,br:1,frame:1,iframe:1,textarea:1}),E),C="msnotranslate",N=()=>!0,y=T({INPUT:[{predicate:t=>["button","submit","reset"].includes(t?.type),attributes:["value"]},{predicate:t=>["image"].includes(t?.type),attributes:["alt"]},{predicate:N,attributes:["placeholder"]}],TEXTAREA:[{predicate:N,attributes:["placeholder"]}],IMG:[{predicate:N,attributes:["alt"]}],AREA:[{predicate:N,attributes:["alt"]}],OPTION:[{predicate:N,attributes:["label"]}],OPTGROUP:[{predicate:N,attributes:["label"]}],TRACK:[{predicate:N,attributes:["label"]}]}),O=T({true:_.On,yes:_.On,false:_.Off,no:_.Off,skip:_.Skip}),R=T({translate:O}),A=T({notranslate:_.Off,skiptranslate:_.Skip,[C]:_.Off}),v="_mstHidden",D="_mstHiddenAttr",w="_mstVisible",x=f(["_mstTextHash","_msthash",v,D,w,...new Set(Object.values(y).flat().map(t=>t.attributes).flat().map(t=>"_mst"+t))]),k=f(["style","class"]);var L;!function(t){t[t.Auto=0]="Auto",t[t.Scrolled=1]="Scrolled",t[t.Mutation=2]="Mutation",t[t.VisibilityChange=3]="VisibilityChange"}(L||(L={}));const M=/\d+(?![a-zA-Z\d\s]*\/?>)/g,I="<>";function P(t,e){if(t.nodeType!=Node.ELEMENT_NODE)return"";const n=window.getComputedStyle(t);return n&&n[e=e.replace(/([A-Z])/g,"-$1").toLowerCase()]||""}function U(t){return encodeURIComponent(t).replace(/%\w\w/g," ").length}function H(t,e){return t.nodeType===Node.ELEMENT_NODE?t.getAttribute(e)||t[e]:null}function V(t,...e){Promise.resolve().then(()=>t(...e))}const F=window;let j;function q(t){B(),j=new AbortController,F.addEventListener("scroll",t,{capture:!0,once:!0,signal:j.signal})}function B(){j?.abort(),j=void 0}function J(t){try{let e=0,n=t.contentWindow;for(;n&&n!=top;)e++,n=n.parent;return e}catch(t){return h.debug(t),11}}function z(t){try{return t.contentWindow&&t.contentWindow.document&&t.contentWindow.document.documentElement&&t.contentWindow.document.body&&J(t)<=10}catch{}return!1}function G(t){try{return t&&t.contentWindow&&t.contentWindow.document||!1}catch{}return!1}const W={ar:!0,fa:!0,he:!0,ku:!0,ps:!0,ur:!0};class X{constructor(t,e){this.name=e,this.code=X.normalizeCode(t)}toString(){return`${this.code}: ${this.name}`}static isRtl(t){return(t=X.normalizeCode(t)).toLowerCase()in W}static equals(t,e){return null!=t&&null!=e&&t.code===e.code}static normalizeCode(t){let e="",n="",s="";const r=t.split("-");e=r[0].toLowerCase();for(let t=1;t<r.length&&!s&&!n;t++)2===r[t].length?(n=r[t].toUpperCase(),"zh"===e&&"CN"===n?s="Hans":"zh"==e&&"TW"===n&&(s="Hant")):3!==r[t].length||n?4!==r[t].length||n||(s=r[t][0].toUpperCase()+r[t].substring(1).toLowerCase()):"CHS"===r[t].toUpperCase()?s="Hans":"CHT"===r[t]&&(s="Hant");"nb"===e?e="no":"und"===e&&(e="");let o=e;return s&&(o+="-"+s),o}}const K=/[\s\xA0]/g,Q=/[\s\xA0]+/g,$=/&/g,Y=/</g,Z=/>/g,tt=/<\s*(\/)?\s*(\w+)\s*(\d*)\s*>/g,et=/&amp;/gi,nt=/&lt;/gi,st=/&gt;/gi,rt=/<\/?\w+>/g,ot=/<(?!\/?b\d+>)[^>]*>/g;function it(t){if(!t||"string"!=typeof t.nodeName)return[];const e=new Set,n=y.get(t.nodeName);for(let s=0;n&&s<n.length;s++)if(!0===n[s].predicate(t))for(let r=0;r<n[s].attributes.length;r++){const o=t.getAttribute(n[s].attributes[r]);o&&o.length>0&&o.trim().length>0&&e.add(n[s].attributes[r])}if(t.hasAttribute("aria-label")){const n=t.getAttribute("aria-label");n&&n.length>0&&e.add("aria-label")}return[...e]}function at(t){if(t.nodeType==Node.TEXT_NODE)return!0;if(t.nodeType!=Node.ELEMENT_NODE)return!1;const e=t;if(z(e))return!0;if(!e.hasChildNodes()&&!(e.nodeName in y)||E.has(e.nodeName.toLowerCase()))return!1;const n=lt(e);return n!=_.Off&&n!=_.Skip&&function(t){if(!t||!t.children)return!1;const e=[0];let n=0;for(;e.length>0&&t;){if(e.length>=5)return!0;const s=e.length-1;if(!t.children||e[s]>=t.children.length){if(e.pop(),0===e.length)break;t=t.parentNode}else{if(z(t.children[e[s]])||it(t.children[e[s]]).length>0)return!0;t=t.children[e[s]],e[s]=e[s]+1,e.push(0),n=Math.max(n,e.length)}}const s=t?.textContent;return!!s&&ut(s)}(e)}function lt(t){let e=_.Inherit;if(!t||t.nodeType!=Node.ELEMENT_NODE)return e;for(const n in R){const s=H(t,n);if(null!=s){const t=R.get(n);if(e=t&&t[s.toString().toLowerCase()]||e,e==_.Off||e==_.Skip)return e}}const n=H(t,"class")||H(t,"className");if(null!=n){const t=n.toString().split(" ");for(let n=0;n<t.length;n++){const s=t[n];if(e=A.get(s.toLowerCase())||e,e==_.Off)return e}}return e}function ut(t){return new RegExp("[a-zA-Z0-9\\?!"+String.fromCodePoint(191)+String.fromCodePoint(161)+".,:\\|"+String.fromCodePoint(192)+"-"+String.fromCodePoint(65535)+"]").test(t)}function ht(t){return t.nodeType==Node.TEXT_NODE||!(!t.nodeName||!S.has(t.nodeName.toLowerCase()))||t.nodeType==Node.ELEMENT_NODE&&!t._mstChunk&&"inline"==P(t,"display").toLowerCase()&&"static"==P(t,"position").toLowerCase()&&![...t.childNodes].some(t=>!ht(t))}function ct(t){if(!t)return 0;t=t.replace(K,"");let e=0;for(let n=0;n<t.length;++n)e+=13*t.charCodeAt(n)*(n+7);return e}function dt(t,e,n){let s=ct(t);for(;e[s];)s+=1;return e[s]=n,s}function gt(t,e,n=1){if(n>9)return"";const s=[];let r=0;for(let o=0;o<t.childNodes.length;++o)switch(t.childNodes[o].nodeType){case Node.ELEMENT_NODE:{const i=e+n.toString()+r.toString(),a=lt(t.childNodes[o]),l=t.childNodes[o].previousSibling,u=t.childNodes[o].nextSibling;a==_.Skip&&l&&l.nodeType==Node.ELEMENT_NODE?l._mstSkipNext=r:a==_.Skip&&u&&u.nodeType==Node.ELEMENT_NODE?u._mstSkipPrev=r:(s.push("<"),s.push(i),s.push(">"),a!=_.Skip&&s.push(gt(t.childNodes[o],e,n+1)),s.push("</"),s.push(i),s.push(">")),++r;break}case Node.TEXT_NODE:{const e=t.childNodes[o].nodeValue;e&&s.push(pt(e));break}}return s.join("")}function pt(t){return t&&t.replace($,"&amp;").replace(Y,"&lt;").replace(Z,"&gt;").replace(Q," ")}function mt(t){if(t)if("frame"==t.nodeName.toLowerCase()||"iframe"==t.nodeName.toLowerCase()){const e=t.contentWindow?.document.documentElement;try{e&&mt(e)}catch{}}else{if(t._mstStyle)for(const e in t._mstStyle)try{t.style[e]=t._mstStyle[e]}catch(t){h.error(t)}if(t._mstStyle=null,t._mstSrcAttribute)for(const e in t._mstSrcAttribute)t.setAttribute(e,t._mstSrcAttribute[e]);if(x.forEach(e=>t.removeAttribute?.(e)),t._mstSrcHtml&&t._mstSrcHtml.childNodes.length>0){for(;t.childNodes.length>0&&t.lastChild;)t.removeChild(t.lastChild);for(;t._mstSrcHtml.childNodes.length>0;)t.appendChild(t._mstSrcHtml.childNodes[0]);t._mstSrcHtml=void 0}else for(let e=0;e<t.childNodes.length;++e)try{const n=t.childNodes[e];n.nodeType==Node.ELEMENT_NODE&&mt(n)}catch{}}}function Tt(t,e,n){try{if(e)return;let s=!1;if(t&&"x-mst-element"in t&&(t=t["x-mst-element"],s=!0),!n||!t||!t.getAttribute)return;if(t.adjustAlign=t.getAttribute("adjustalign")&&"false"!=t.getAttribute("adjustalign").toLowerCase(),null==t.adjustAlign&&t.parentNode&&(t.adjustAlign=t.parentNode.adjustAlign),null!=t.adjustAlign&&null!=t.adjustAlign||(t.adjustAlign=!0),t.style&&(s||at(t))&&t.adjustAlign){for(;!s&&"inline"===P(t,"display");)t=t.parentNode;for(const e in n)if(e in n)try{const s=P(t,e);if(s!=n[e]){if("textAlign"==e&&(s&&-1!=s.toLowerCase().indexOf("center")||t.tagName&&"center"==t.tagName.toLowerCase()))continue;t._mstStyle||(t._mstStyle={}),t.style&&t.style[e]?t._mstStyle[e]=t.style[e]:t._mstStyle[e]=s,t.style&&(t.style[e]=n[e])}}catch(t){h.error(t)}}}catch(t){h.error(t)}}function ft(t){return t.replace(M,I)}function Et(t,e){return t.replace(M,t=>(e.push(t),I))}function bt(t,e){for(;0!=e.length;)t=t.replace(I,e.shift());return t}function _t(t,e,n=1){if(!(n>9))for(const s of t.childNodes)s.nodeType==Node.ELEMENT_NODE&&(e(s),_t(s,e,n+1))}class St{constructor(t,e,n,s,r,o,i=!1){this._sFrom=t,this._sTo=e,this._aTextArray=n,this._oJobData=s,this._fOnSuccess=r,this._fOnError=o,this._bBuffered=i}isBufferedRequest(){return this._bBuffered}onSuccess(t){this._fOnSuccess&&this._fOnSuccess(this._oJobData,t)}onError(t){this._fOnError&&this._fOnError(this._oJobData,t)}}class Ct{constructor(t,e,n){this._iMaxParallelJobs=t,this._iMaxChunkSize=e,this._fOnTranslateApiCalled=n,this._aJobs=[],this._iActiveJobs=0,this._iTotalTriggeredJobs=0}purgeQueue(){this._aJobs=[],h.debug("Purging jobQueue. Having",this._iActiveJobs,"active jobs currently.")}addJob(t){this._aJobs.push(t),h.debug("Adding job to jobQueue. Active Jobs: ",this._iActiveJobs,", Remaining Jobs: ",this._aJobs.length),this.startProcessing()}startProcessing(){if(this._aJobs.length>0&&this._iActiveJobs<this._iMaxParallelJobs){const t=this._aJobs.shift();if(t.isBufferedRequest())return void this.processBufferedRequest(t);d.translateAsync(t._sFrom,t._sTo,t._aTextArray,this._fOnTranslateApiCalled).then(e=>{this._iActiveJobs-=1,t.onSuccess(e),this.startProcessing()},e=>{this._iActiveJobs-=1,t.onError(e),this.startProcessing()}),this._iActiveJobs+=1,this._iTotalTriggeredJobs+=1,this.optimizeParallelRequestsAmount()}}processBufferedRequest(t){const e=function(t,e){const n=[];for(;t.length>e;)n.push(t.substr(0,e)),t=t.substr(e);return 0==t.length&&0!=n.length||n.push(t),n}(t._aTextArray[0],this._iMaxChunkSize),n={};let s=!1;e.forEach((r,o)=>{const i=new St(t._sFrom,t._sTo,[r],o,(r,o)=>{if(n[r]=o,!s&&Object.keys(n).length==e.length){const s=[{From:"",TranslatedText:"",OriginalTextSentenceLengths:[],TranslatedTextSentenceLengths:[]}];for(let t=0;t<e.length;t++){const e=n[t][0];s[0].From=e.From,s[0].TranslatedText+=e.TranslatedText,s[0].OriginalTextSentenceLengths.push(...e.OriginalTextSentenceLengths),s[0].TranslatedTextSentenceLengths.push(...e.TranslatedTextSentenceLengths)}t.onSuccess(s)}},(e,n)=>{s=!0,t.onError(n),this.startProcessing()});this.addJob(i)})}numOfTotalJobsInQueue(){return this._aJobs.length+this._iActiveJobs}optimizeParallelRequestsAmount(){this._iTotalTriggeredJobs>33?this._iMaxParallelJobs=2:this._iMaxParallelJobs>3&&this._iTotalTriggeredJobs%10==0&&(this._iMaxParallelJobs=this._iMaxParallelJobs-this._iMaxParallelJobs/3)}}class Nt{constructor(t=[]){this.pop=()=>this.items.pop(),this.shift=()=>this.items.shift(),this.push=t=>this.items.push(t),this.items=[...t]}get first(){return 0==this.length?void 0:this.items[0]}get top(){return 0==this.length?void 0:this.items[this.length-1]}get length(){return this.items.length}*[Symbol.iterator](){for(const t of this.items)yield t}get(t){return this.length<=t?void 0:this.items[t]}clear(){this.items.length=0}isEmpty(){return 0==this.items.length}}const yt=Object.freeze({outsideView:1,insideView:2,hidden:4,cached:8,unknown:64});function Ot(t){try{const n=(e=t,e&&e.nodeType==Node.ELEMENT_NODE&&["option","optgroup"].includes(e.nodeName.toLowerCase())&&(e=e.closest("select")),t=e).nodeType===Node.ELEMENT_NODE?t:t.parentElement;let s;if(!["title"].includes(t.nodeName.toLowerCase())&&n&&n.nodeType===Node.ELEMENT_NODE&&(s=n.getBoundingClientRect())){if(0===s.height||0===s.width)return yt.hidden;const t=window.innerHeight||document.documentElement.clientHeight;return s.top>=0&&s.top<=t+1e3||s.bottom>=0&&s.bottom<=t+1e3?yt.insideView:yt.outsideView}return yt.insideView}catch{return yt.insideView}var e}function Rt(t,e,n){t&yt.unknown||(n.items[n.length-1]++,t&yt.hidden&&e.items[e.length-1]++)}function At(t,e,n){e.top&&e.top>0&&e.top===n.top&&t.length>0&&t.top?.nodeType==Node.ELEMENT_NODE&&t.top.setAttribute(v,e.top.toString());let s=e.pop();e.length>0&&(e.items[e.length-1]+=s),s=n.pop(),n.length>0&&(n.items[n.length-1]+=s)}function vt(t){let e=!0;const n=performance.now();if("x-mst-element"in t)return e;try{const s=t.nodeType===Node.ELEMENT_NODE?t:t.parentElement;let r;if(s&&(r=s.getBoundingClientRect()))if(0===r.height||0===r.width)e=!0,s._mstScrolledData=!0,s._mstScrolledTime=n;else{const t=window.innerHeight||document.documentElement.clientHeight;e=r.top<=t||r.bottom<=t}}catch{}return e}function Dt(t,e,n,s,r){if("function"!=typeof n)throw Error("There was no handler assigned for processing nodes.");const o=new Nt;o.push({node:t,depth:0});let i=0;const a="function"==typeof e;for(;!o.isEmpty();){const t=o.pop(),l=t.node.getAttribute("_msthash"),u=t.node.getAttribute(D);if(t.node.hasAttribute(w))h.debug("Element id "+l+" should already be visible.");else{if(t.node.setAttribute(w,t.depth.toString()),t.node.removeAttribute(v),u&&a&&u in r){const n=r[u];for(let t=0;t<n.attributes.length;t++){const s=n.attributes[t];e(n.element,s.attribute,s.text)}delete r[u],t.node.removeAttribute(D),i++}if(l&&l in s){const t=s[l];n(t.element,t.stringValue),delete s[l],i++}else for(let e=0;e<t.node.children.length;e++){const n=t.depth+1;n>5&&h.debug("Element contains children deeper than threshold while marking visible. Depth: "+n),o.push({node:t.node.children[e],depth:n})}}}return i}class wt{constructor(t,e,n,s,r,o,i,a,l){var u,c,d;this._allDetectedLanguages={},this.bTranslateSelectedTextOnly=!1,this.bTranslateFullPageInOneGo=!1,this.iScrolledElementsTranslated=0,this.iHiddenElementsTranslated=0,this.bOnIntermediateCompleteCalled=!1,this.bAutoTraversalCompleted=!1,this._iParallelReq=4,this._oMObservers=[],this.oTranslateMutationTask=null,this._maxIframeDepthSupported=10,this._maxTraversalIterations=1e4,this._aTranslatedNodes=[],this.bFlushedStartTerminalNode=!1,this.isTraverseDOMActive=!1,this.bSentTranslationComplete=!1,this.bSentTranslationError=!1,this._iMinReq=3500,this._iMaxReq=4e3,this._iMaxElementsPerRequest=100,this._iVisibleTxtLength=0,this._bAborted=!1,this.translationDictionary={},this._aDomChunks=[],this._aTxtChunks=[],this._visibleDomChunks=[],this._visibleTxtChunks=[],this.oHiddenChunks={},this.oHiddenAttributes={},this._bScrollingStopped=!1,this._bTxtChunksFlushed=!1,this.fontMutation=new Map,this.translateMutation=new Map,this.attributeMutation=new Map,this.traverseDOMRecursive=(t,e,n,s)=>{let r=t.domStack,o=t.properties,i=t.offsetFromStart,a=t.hidden,l=t.elements;const u=()=>function(t,e){let n="";for(let s=t.length-2;s>=0;--s){s!=t.length-2&&(n+="_");const r=t.get(s);if("id"in r&&r.id&&r.id.isBlank&&!r.id.isBlank()){n+=r.id;break}n+=(r.nodeName?.toLowerCase()||"")+"-"+e.get(s).toString()}return n}(r,i),h=t=>{Rt(this.flushChunk([t],u,!0),a,l)};let c=0;for(;c<this._maxTraversalIterations&&r.length>0&&(this._iVisibleTxtLength<this._iMinReq||n.length);){if(z(r.top)){const t=r.top;r.push(t.contentWindow.document.body),o.push({isRoot:!1,traverseTerminalOnly:o.top.traverseTerminalOnly}),i.push(0),this.flush(n,s,a,l),s=null,a.push(0),l.push(0)}else if(!r.top.firstChild||!o.top.isRoot&&o.top.traverseTerminalOnly||ht(r.top)||!at(r.top)){for(;r.length&&r.top&&o.top&&!0!==o.top.isRoot&&!r.top.nextSibling&&(1!=r.top.nodeType||!r.top.nextElementSibling);)r.pop(),o.pop(),i.pop(),this.flush(n,s,a,l),s=null,At(r,a,l);!1===o.top.isRoot?(r.push(r.pop().nextSibling),ht(r.top)?_t(r.top,h):h(r.top)):(r.pop(),o.pop(),i.pop(),this.flush(n,s,a,l),s=null,At(r,a,l))}else r.push(r.top.firstChild),o.push({isRoot:!1,traverseTerminalOnly:o.top.traverseTerminalOnly}),i.push(0),this.flush(n,s,a,l),s=null,a.push(0),l.push(0),ht(r.top)?_t(r.top,h):h(r.top);if(r.length){const t=(r.top.nodeName||"").toLowerCase();ht(r.top)&&!E.has(t)&&"iframe"!=t&&"frame"!=t&&(s||(s=u()),++i.items[i.length-1],n.push(r.top))}if(0===n.length&&!r.isEmpty()&&G(r.top)){if(window.requestAnimationFrame(()=>{V(this.traverseDOMRecursive,t,e,n,s)}),this._bScrollingStopped)break;return}r=t.domStack,o=t.properties,i=t.offsetFromStart,a=t.hidden,l=t.elements,c++}if(c==this._maxTraversalIterations)return void this.traverseDOMRecursive(t,e,n,s);let d=0;for(;(this._iVisibleTxtLength<this._iMinReq||this._bScrollingStopped)&&d<this._aDomChunks.length&&d<this._aTxtChunks.length;){let t=this._aDomChunks[d];t="x-mst-attribute"in t?t["x-mst-element"]:t,Ot(t)===yt.insideView?(this._iVisibleTxtLength+=U(this._aTxtChunks[d]),this._visibleDomChunks=this._visibleDomChunks.concat(this._aDomChunks.splice(d,1)),this._visibleTxtChunks=this._visibleTxtChunks.concat(this._aTxtChunks.splice(d,1))):d++}if(this._visibleTxtChunks.length>0||this._bTxtChunksFlushed||this._bScrollingStopped)this._bTxtChunksFlushed=!1,this._bScrollingStopped=!1,this.translate(t,e);else{if(this.bAutoTraversalCompleted=this.bAutoTraversalCompleted||e===L.Auto&&0===r.length,this._jobQueue.numOfTotalJobsInQueue()>0)return;this.isTraverseDOMActive=!1,this.bAutoTraversalCompleted&&this.translationComplete()}},this.traverseDOM=(t,e)=>{try{const n=[];this._eDomRoot&&ht(this._eDomRoot)&&!this.bFlushedStartTerminalNode&&(this.bFlushedStartTerminalNode=!0,this.flushChunk([this._eDomRoot],"start.terminal.node")),V(this.traverseDOMRecursive,t,e,n,null)}catch(t){h.error("Unknown error in traverseDom.",t)}},this._sFrom=e,this._sTo=n,this._eDomRoot=t,this._fComplete=s,this._fVisibleComplete=a,this._fError=function(t){if("function"==typeof r)try{r(Mt(t))}catch(t){h.error("Encountered exception while calling error handler",t)}},this.bTranslateSelectedTextOnly=!0===o,this.bTranslateFullPageInOneGo=!0===i,this._jobQueue=new Ct(this._iParallelReq,this._iMinReq,l),this._aDomStack=new Nt([this._eDomRoot]),this._aDomProperties=new Nt,this._aDomProperties.push({isRoot:!0,traverseTerminalOnly:!1}),this._aDomOffset=new Nt([0]),this._aHiddenElementCount=new Nt([0]),this._aElementCount=new Nt([0]),this._oApplyStyle=(u=this._sFrom,c=this._sTo,X.isRtl(u)===X.isRtl(c)?null:(d=c,X.isRtl(d)?{direction:"rtl",textAlign:"right"}:{direction:"ltr",textAlign:"left"}))}translationComplete(){if(g.requestsInitiated&&(h.info("Took "+(performance.now()-g.translationStartTime)+" ms to translate"),g.translationStartTime=performance.now(),g.requestsInitiated=!1),!this.bSentTranslationComplete){if(this.bSentTranslationComplete=!0,this._eDomRoot&&this.bTranslateSelectedTextOnly&&this._aTranslatedNodes.length){!function(t,e){if(!t||!e||!e.length)return;const n=new Jt;let s=0;for(n.push(0);s<e.length&&n.length&&t;){const r=e.indexOf(t);if(r>=0){const o=e[s];e[s]=e[r],e[r]=o,s++,t=t.parentNode,n.pop()}else n.top<t.childNodes.length?(t=t.childNodes[n.top],n.top++,n.push(0)):(t=t.parentNode,n.pop())}for(;s<e.length;)e.pop()}(this._eDomRoot,this._aTranslatedNodes);const t=this._eDomRoot.ownerDocument.createRange();t.setStartBefore(this._aTranslatedNodes[0]),t.setEndAfter(this._aTranslatedNodes[this._aTranslatedNodes.length-1]);const e=this._eDomRoot.ownerDocument.defaultView?.getSelection();e?.removeAllRanges(),e?.addRange(t)}this.bSentTranslationError||this.bOnIntermediateCompleteCalled||(this.bOnIntermediateCompleteCalled=!0,this._fVisibleComplete(!0)),this.bSentTranslationError||this._fComplete()}}getDefaultTraversalStacks(){return{domStack:this._aDomStack,properties:this._aDomProperties,offsetFromStart:this._aDomOffset,hidden:this._aHiddenElementCount,elements:this._aElementCount}}createEmptyTraversalStack(){return{domStack:new Nt,properties:new Nt,offsetFromStart:new Nt,hidden:new Nt,elements:new Nt}}isChildOfAnyNoTranslateElement(t){return this._msNoTranslateElements||(this._msNoTranslateElements=document.getElementsByClassName(C)),[...this._msNoTranslateElements].some(e=>e.contains(t))}markNodesAsVisible(t){return Dt(t,(t,e,n)=>{this._iVisibleTxtLength+=U(n),this._visibleDomChunks.push({"x-mst-element":t,"x-mst-attribute":e}),this._visibleTxtChunks.push(n)},(t,e)=>{this._iVisibleTxtLength+=U(e),this._visibleDomChunks.push(t),this._visibleTxtChunks.push(e)},this.oHiddenChunks,this.oHiddenAttributes)}markNodesAsOutsideView(t){return Dt(t,(t,e,n)=>{this._aDomChunks.push({"x-mst-element":t,"x-mst-attribute":e}),this._aTxtChunks.push(n)},(t,e)=>{this._aDomChunks.push(t),this._aTxtChunks.push(e)},this.oHiddenChunks,this.oHiddenAttributes)}pushIntoTraversalStack(t,e,n){t.domStack.push(e),t.properties.push({isRoot:!0,traverseTerminalOnly:n}),t.offsetFromStart.push(0),t.hidden.push(0),t.elements.push(0),this.flushChunk([e],"",!0)}updateAddedIframe(t){J(t)>this._maxIframeDepthSupported||(t.contentWindow.document.body?this.updateAddedIframeBody(t):t.contentWindow.onload=()=>this.updateAddedIframeBody(t))}updateAddedIframeBody(t){"complete"==t.contentWindow?.document.readyState?this.addIframeForTranslation(t):t.contentWindow.document.body.onload=()=>this.addIframeForTranslation(t)}addIframeForTranslation(t){const e=this.createEmptyTraversalStack();this.pushIntoTraversalStack(e,t,!1),this.isTraverseDOMActive||(this.isTraverseDOMActive=!0,g.translationStartTime=performance.now()),V(this.traverseDOM,e,L.Mutation),this.setMutationObserversForDocument(t.contentWindow)}addMutationObserver(t){const e=new Map,n=new Map;this._oMObservers.push(new MutationObserver(t=>{let s=!1;e.clear(),n.clear(),t.forEach(t=>{switch(t.type){case"characterData":{if(this.translateMutation.has(t.target)){const e=this.translateMutation.get(t.target);1===e?this.translateMutation.delete(t.target):this.translateMutation.set(t.target,e-1);break}if(this.isChildOfAnyNoTranslateElement(t.target))break;let r=!0,o=t.target;for(;ht(o);){if(null===o.parentNode||void 0===o.parentNode){r=!1;break}o=o.parentNode}if(!r){s=!0;const e=t.target.nodeType===Node.TEXT_NODE?t.target.nodeValue:t.target.textContent;this.flushChunk([t.target],e);break}const i=o;if(o.nodeType===Node.ELEMENT_NODE&&o.hasAttribute("_mstHash")){if(!i.hasAttribute("_mstTextHash")||i.getAttribute("_mstTextHash")!=ct(o.textContent).toString()){s=!0;const e=t.target.nodeType===Node.TEXT_NODE?t.target.nodeValue:t.target.textContent;this.flushChunk([t.target],e??"")}break}e.has(o)||n.has(o)||(s=!0,e.set(o,1));break}case"attributes":if(k.some(e=>e===t.attributeName)){const e=t.target;if(t.target.nodeType==Node.ELEMENT_NODE&&e.getAttribute(v)){const t=Ot(e);let n=0;t&yt.insideView?(n=this.markNodesAsVisible(e),0===n?h.debug("A previously marked hidden chunk became visible but could not be located."):this.oTranslateMutationTask=(r=()=>{this.translate(this.createEmptyTraversalStack(),L.VisibilityChange)},(o=this.oTranslateMutationTask)&&!o.isCompleted||(o={rafRequestId:null,isCompleted:!1}),null!==o.rafRequestId&&cancelAnimationFrame(o.rafRequestId),o.rafRequestId=requestAnimationFrame(function(){V(r),o.isCompleted=!0}),o)):t&yt.outsideView&&(n=this.markNodesAsOutsideView(e),0===n&&h.debug("A previously marked hidden chunk became un-hidden but could not be located."))}break}if(this.attributeMutation.has(t.target)){const e=this.attributeMutation.get(t.target),n=t.attributeName;if(n&&n in e){1===e[n]?delete e[n]:e[n]-=1;break}}if(this.isChildOfAnyNoTranslateElement(t.target))break;s=!0,this.flushChunk([t.target],"",!0);break;case"childList":for(let r=0;r<t.addedNodes.length;r++){const o=t.addedNodes[r];if(o.nodeType===Node.ELEMENT_NODE&&(o.hasAttribute("_isTranslated")||o.hasAttribute("_mstMutation")))continue;if(this.fontMutation.has(o)){this.fontMutation.delete(o);continue}if(this.translateMutation.has(o)){const t=this.translateMutation.get(o);1===t?this.translateMutation.delete(o):this.translateMutation.set(o,t-1);continue}if(this.isChildOfAnyNoTranslateElement(o))continue;if(!ht(o)){n.has(o)||o.nodeType!==Node.ELEMENT_NODE||o.hasAttribute("_mstHash")&&o.hasAttribute("_mstTextHash")&&o.getAttribute("_mstTextHash")==ct(o.textContent).toString()||(s=!0,n.set(o,1),e.has(o)&&e.delete(o));continue}if(G(o)){const t=o;t.hasAttribute("_mstHash")&&t.hasAttribute("_mstTextHash")&&t.getAttribute("_mstTextHash")==ct(o.textContent).toString()||this.updateAddedIframe(t);continue}let i=!0,a=o;for(;ht(a);){if(null===a.parentNode||void 0===a.parentNode){i=!1;break}a=a.parentNode}if(i)if(a.nodeType===Node.ELEMENT_NODE&&a.hasAttribute("_mstHash")){if("select"===a.nodeName.toLowerCase())continue;if(!a.hasAttribute("_mstTextHash")||a.getAttribute("_mstTextHash")!=ct(a.textContent).toString()){s=!0;const t=o.nodeType===Node.TEXT_NODE?o.nodeValue:o.textContent;this.flushChunk([o],t)}}else e.has(a)||n.has(a)||(s=!0,e.set(a,1));else{s=!0;const t=o.nodeType===Node.TEXT_NODE?o.nodeValue:o.textContent;this.flushChunk([o],t)}}}var r,o});const r=this.createEmptyTraversalStack();Array.from(e.keys()).forEach(t=>{this.pushIntoTraversalStack(r,t,!0)}),Array.from(n.keys()).forEach(t=>{this.pushIntoTraversalStack(r,t,!1)}),s&&(s=!1,this.isTraverseDOMActive||(this.isTraverseDOMActive=!0,g.translationStartTime=performance.now()),V(this.traverseDOM,r,L.Mutation))})),this._oMObservers[this._oMObservers.length-1].observe(t.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0,attributeFilter:["value","placeholder","aria-label",...k]})}setMutationObserversForDocument(t){if("MutationObserver"in t&&!this.bTranslateSelectedTextOnly&&!this.bTranslateFullPageInOneGo){const e=t.document;this.addMutationObserver(e);const n=e.querySelectorAll("iframe");for(let t=0;t<n.length;t++)n[t]&&z(n[t])&&this.setMutationObserversForDocument(n[t].contentWindow)}}cancel(){const t=performance.now();this._oMObservers.forEach(t=>t.disconnect()),B(),this._eDomRoot&&(this._bAborted=!0,this._jobQueue.purgeQueue(),function(){const t=document.querySelector("head > title");t&&mt(t)}(),this.bTranslateSelectedTextOnly?mt(document.body):mt(this._eDomRoot),this._eDomRoot=null,h.info("Took "+(performance.now()-t)+" ms to untranslate."))}getDetectedLanguage(){return this._detectedLanguage}getAllDetectedLanguages(){return this._allDetectedLanguages}flushChunk(t,e,n=!1){let s=yt.unknown;const r="string"==typeof e?e:null;for(let n=0;n<t.length;n++){if(t[n].nodeType==Node.TEXT_NODE||t[n].nodeType!=Node.ELEMENT_NODE)continue;const r=t[n],o=it(r);let i=null;if(o.length>0&&(s=Ot(r),s&yt.hidden)){let t=null,s=null;if("function"==typeof e){const s=e();s&&(t="a"+n+s)}else"string"==typeof e&&e&&(t="a"+n+e);i={element:r,attributes:[]},t&&(s=dt(t,this.oHiddenAttributes,i)),r.setAttribute(v,"A"),r.setAttribute(D,(s??"null").toString())}for(let t=0;t<o.length;t++){const e=pt(r.getAttribute(o[t]));if(!e)continue;const n=ct(e).toString(),a="_mst"+o[t];if(r.hasAttribute(a)&&r.getAttribute(a)==n)continue;r.setAttribute(a,n);const l=U(e);i?i.attributes.push({attribute:o[t],text:e}):s&yt.outsideView||s&yt.unknown?(this._aDomChunks.push({"x-mst-element":r,"x-mst-attribute":o[t]}),this._aTxtChunks.push(e)):(this._iVisibleTxtLength+=l,this._visibleDomChunks.push({"x-mst-element":r,"x-mst-attribute":o[t]}),this._visibleTxtChunks.push(e)),this._bTxtChunksFlushed=!0}}if(n)return s;if(t[0]&&t[0].parentNode&&t[0].parentNode.nodeType==Node.ELEMENT_NODE&&t[0].parentNode.hasAttribute("_mstTextHash")&&t[0].parentNode.getAttribute("_mstTextHash")==ct(t[0].parentNode.textContent).toString())return t.length=0,s;if(this.trimChunk(t),0===t.length)return s;const o=this.chunkify(t);if((i=o).nodeName&&b.has(i.nodeName.toLowerCase()))return s;var i;const a=o.textContent,l=ct(a).toString();if(o.hasAttribute("_mstTextHash")&&o.getAttribute("_mstTextHash")==l)return s;let u=null;if(o&&at(o)){o.hasAttribute("_mstHash")?u=o.getAttribute("_mstHash"):(u=dt(r,this,o).toString(),o.setAttribute("_mstHash",u));const t=gt(o,"b");if(ut(t)){const e=U(t);a&&!a.isBlank()&&o.setAttribute("_mstTextHash",l),s=Ot(o),this.bTranslateSelectedTextOnly||this.bTranslateFullPageInOneGo||s&yt.insideView?(this._iVisibleTxtLength+=e,this._visibleDomChunks.push(o),this._visibleTxtChunks.push(t)):s&yt.hidden?(o.setAttribute(v,"1"),this.oHiddenChunks[u]={element:o,stringValue:t}):(this._aDomChunks.push(o),this._aTxtChunks.push(t)),this._bTxtChunksFlushed=!0,this.bTranslateSelectedTextOnly&&this._aTranslatedNodes.push(o)}}return s}flush(t,e,n,s){if(t.length)try{Rt(this.flushChunk(t,e),n,s)}catch(t){h.error(t)}}identifySingleTranslatableElementNode(t,e=1){if(t.nodeType!=Node.ELEMENT_NODE||e>9)return t;const n=Array.from(t.childNodes);for(;n.length>1&&this.canTrimNode(n[n.length-1]);)n.pop();for(;n.length>1&&this.canTrimNode(n[0]);)n.shift();return 1==n.length&&n[0].nodeType==Node.ELEMENT_NODE?this.identifySingleTranslatableElementNode(n[0],e+1):t}chunkify(t){let e=null;if(t.length>0){let n=t[0];if(1==t.length&&n.nodeType==Node.ELEMENT_NODE)e=this.identifySingleTranslatableElementNode(t.pop());else if(n.parentNode&&t.length==n.parentNode.childNodes.length)e=t.pop().parentNode,t.length=0;else for(e=n.ownerDocument.createElement("font"),e.setAttribute("_mstMutation","1"),e._mstChunk=!0,n.parentNode&&n.parentNode.insertBefore(e,n);t.length>0;)n=t[0],n.nodeType==Node.ELEMENT_NODE&&n.setAttribute("_mstMutation","1"),n.nodeType==Node.TEXT_NODE&&this.fontMutation.set(n,1),e.appendChild(t.shift())}return e}trimChunk(t){let e=!0;for(;e;){if(e=!1,1==t.length&&!at(t[0]))return;if(1==t.length&&t[0].nodeType==Node.ELEMENT_NODE&&!ht(t[0])&&t[0].childNodes.length>0){const n=t.pop();for(let e=0;e<n.childNodes.length;e++)t.push(n.childNodes[e]);e=!0}t.length>0&&(this.canTrimNode(t[0])?(t.shift(),e=!0):this.canTrimNode(t[t.length-1])&&(t.pop(),e=!0))}1==t.length&&this.canTrimNode(t[0])&&t.pop()}canTrimNode(t){if(this._eDomRoot&&this.bTranslateSelectedTextOnly&&(t.nodeType===Node.TEXT_NODE&&!this._eDomRoot.ownerDocument.defaultView?.getSelection()?.containsNode(t,!1)||t.nodeType===Node.ELEMENT_NODE&&!this._eDomRoot.ownerDocument.defaultView?.getSelection()?.containsNode(t,!0)))return!0;let e="";switch(t.nodeType){case Node.ELEMENT_NODE:e=t.textContent||"";break;case Node.TEXT_NODE:e=t.nodeValue||"";break;default:return!0}return!ut(e)}denormalizeElementRecursive(t,e,n,s){if(!t||!e||"string"!=typeof n||"number"!=typeof s||s>9)return;let r=0;const o=[],i=[];for(let e=0;e<t.childNodes.length;e++){const n=t.childNodes[e];n.nodeType===Node.ELEMENT_NODE?o.push(n):n.nodeType===Node.TEXT_NODE&&i.push(n)}for(let a=0;a<e.childNodes.length;a++){const l=e.childNodes[a];let u=null;if(l.nodeType===Node.TEXT_NODE){if(i.length>0){u=i.shift();const t=this.translateMutation.has(u)?this.translateMutation.get(u)+1:1;this.translateMutation.set(u,t),u.nodeValue=l.nodeValue}else u=document.createTextNode(l.nodeValue);if(this.bTranslateSelectedTextOnly&&this._detectedLanguage&&X.isRtl(this._detectedLanguage)!==X.isRtl(this._sTo)){const t=X.isRtl(this._sTo)?String.fromCodePoint(8207):String.fromCodePoint(8206);u.nodeValue=t+u.nodeValue+t}}else if(l.nodeType===Node.ELEMENT_NODE){const t=l.nodeName;if(t.length<n.length+2||t.substring(0,n.length)!==n)h.error(`Encountered an unexpected node in the returned translated HTML. Expected ${n}${s}X but got ${t}`);else{const e=n.length,r=parseInt(t.substring(e,e+1)),i=parseInt(t.substring(e+1));r!==s?h.error(`Encountered a node at the wrong level. Expected level ${s} but got ${t}`):i>=0&&i<o.length?(u=o[i],u.hasAttribute("_isTranslated")||u.setAttribute("_isTranslated","1"),this.denormalizeElementRecursive(u,l,n,s+1)):h.error(`Encountered a node at with an invalid element index. There are ${o.length} nodes at level ${s} but got ${t}`)}}if(u){if(t.childNodes[r]!==u){if(u.nodeType===Node.TEXT_NODE){const t=this.translateMutation.has(u)?this.translateMutation.get(u)+1:1;this.translateMutation.set(u,t)}t.insertBefore(u,t.childNodes[r])}r++}}for(;r<t.childNodes.length;)t.removeChild(t.lastChild)}denormalizeElement(t,e,n){if(!t||!t.childNodes||"string"!=typeof e||0===e.length||"string"!=typeof n||0===n.length)return;n=n.toUpperCase();const s=document.createElement("div");s.innerHTML=e.replace(tt,"<$1$2$3>"),this.denormalizeElementRecursive(t,s,n,1)}translate(t,e){const n={};let s=0,r=U(this._visibleTxtChunks[0]);do{if(0===this._visibleTxtChunks.length)break;this._iVisibleTxtLength-=r;const t=[],e=Et(this._visibleTxtChunks[0],t),o=this._visibleDomChunks.shift(),i=this._visibleTxtChunks.shift();e in this.translationDictionary?this.translateElement(o,i,bt(this.translationDictionary[e],t)):i in n?n[i].push(o):(n[i]=[o],s+=r),r=this._visibleTxtChunks.length>0?U(this._visibleTxtChunks[0]):0}while(this._visibleDomChunks.length>0&&s<this._iMinReq&&s+r+(Object.keys(n).length+1)*U('"",')<=this._iMaxReq&&Object.keys(n).length<this._iMaxElementsPerRequest);const o=Object.keys(n),i=Object.values(n);s>0&&this._jobQueue.addJob(new St(this._sFrom,this._sTo,o,{Dom:i,Txt:o,Trigger:e},(e,n)=>{this.translateComplete(t,e,n)},(t,e)=>{this.translateError(e)},s>this._iMaxReq)),0==this._jobQueue.numOfTotalJobsInQueue()&&V(this.traverseDOM,t,e)}updateDetectedLanguage(t){if("array"===xt(t))for(let e=0;e<t.length;e++){const n=t[e].From;if(null!=n&&!n.isBlank()){const t=n.toLowerCase();this._allDetectedLanguages[t]=(this._allDetectedLanguages[t]||0)+1,(null==this._detectedLanguage||this._detectedLanguage.isBlank()||this._allDetectedLanguages[t]>this._allDetectedLanguages[this._detectedLanguage])&&(this._detectedLanguage=t)}}}translateComplete(t,e,n){if(!this._bAborted)if(e&&n?.length!==e.Dom.length)this.translateError("Inconsistent Data");else if(n&&0!=n.length)try{const s=e&&"number"==typeof e.Trigger?e.Trigger:null;if(g.requestsInitiated=!0,this.updateDetectedLanguage(n),this._oApplyStyle)for(let t=0;t<e.Dom.length;t++)for(const n of e.Dom[t])Tt(n,this.bTranslateSelectedTextOnly,this._oApplyStyle);const r="";for(let t=e.Dom.pop(),s=e.Txt.pop(),r=n.pop();t&&r&&s;t=e.Dom.pop(),s=e.Txt.pop(),r=n.pop()){try{r.TranslatedText=r.TranslatedText?.replace(ot,function(t){return t.replace($,"&amp;").replace(Y,"&lt;").replace(Z,"&gt;")});for(const e of t)this.translateElement(e,s,r.TranslatedText)}catch(t){h.error(t)}if(!this.bOnIntermediateCompleteCalled&&!this.bTranslateFullPageInOneGo)for(const e of t)vt(e)?this.iScrolledElementsTranslated++:this.iScrolledElementsTranslated>0&&this.iHiddenElementsTranslated++,this.iHiddenElementsTranslated>0&&(this.bOnIntermediateCompleteCalled=!0,this._fVisibleComplete(!1))}0!=r.length&&this._eDomRoot?.setAttribute("mstAlign",r),V(this.traverseDOM,t,s)}catch(t){h.error("Unknown error in translateComplete. ",t)}}translateError(t){try{if(g.requestsInitiated=!0,this.bSentTranslationError||this._bAborted)return;this._fError&&this._fError(t),this.bSentTranslationError=!0}catch(t){h.error("Error in translateError. ",t)}this.bSentTranslationComplete||this.bOnIntermediateCompleteCalled||this.cancel()}translateElement(t,e,n){if(U(e)<60&&(this.translationDictionary[ft(e)]=ft(n)),e===n)return;if("x-mst-attribute"in t){const e=t,r=e["x-mst-element"],o=e["x-mst-attribute"];if(void 0===r._mstSrcAttribute&&(r._mstSrcAttribute={}),r._mstSrcAttribute[o]=r.getAttribute(o),this.attributeMutation.has(r)){const t=this.attributeMutation.get(r);o in t?t[o]+=1:t[o]=1}else{const t={[o]:1};this.attributeMutation.set(r,t)}const i=ct(n),a="_mst"+o;return n.isBlank()||e["x-mst-element"].setAttribute(a,i.toString()),void e["x-mst-element"].setAttribute(e["x-mst-attribute"],(s=n,s&&s.replace(rt,"").replace(st,">").replace(nt,"<").replace(et,"&")))}var s;const r=t;if(r._mstSrcHtml=r.cloneNode(!0),"option"==r.nodeName.toLowerCase())return void this.denormalizeElement(r,n,"b");const o=r;t=o.cloneNode(!0);try{this.denormalizeElement(o,n,"b");const t=o.textContent;t&&!t.isBlank()&&o.setAttribute("_mstTextHash",ct(t).toString())}catch{}}executeTranslation(){if(this._eDomRoot?.nodeType!==Node.ELEMENT_NODE)throw new Error("Invalid input type");if(this._sFrom===this._sTo||!this._eDomRoot.hasChildNodes())return this.translationComplete(),this;if(this.bTranslateSelectedTextOnly||this.bTranslateFullPageInOneGo||function(t){const e=()=>{let n=window.scrollX,s=window.scrollY,r=0;const o=()=>{const i=window.scrollX,a=window.scrollY;n==i&&s==a?r++:(n=i,s=a,r=0),r>=6?(h.debug("Scrolling has stopped."),q(e),V(t)):F.requestAnimationFrame(o)};F.requestAnimationFrame(o)};q(e)}(()=>{0==this._jobQueue.numOfTotalJobsInQueue()&&(this._bScrollingStopped=!0,this.isTraverseDOMActive||(this.isTraverseDOMActive=!0,g.translationStartTime=performance.now()),this.traverseDOM(this.createEmptyTraversalStack(),L.Scrolled))}),this.setMutationObserversForDocument(window),!this.bTranslateSelectedTextOnly){const t=document.querySelector("head > title");t&&this.flushChunk([t],"head.title")}return this.isTraverseDOMActive=!0,this.traverseDOM(this.getDefaultTraversalStacks(),L.Auto),m(this),this}}function xt(t){let e=typeof t;return"object"===e&&(t?"[object Array]"==Object.prototype.toString.call(t)&&(e="array"):e="null"),e}String.prototype.isBlank=String.prototype.isBlank||function(){return null==this||"string"!=typeof this||0===this.trim().length},String.prototype.htmlEscape=String.prototype.htmlEscape||function(){if(!this)return"";const t=document.createElement("span");return t.innerText=this,t.innerHTML};let kt,Lt=null;function Mt(t){switch(xt(t)){case"object":case"array":return JSON.stringify(t);case"null":return"null";case"undefined":return"undefined";default:return t.toString()}}var It,Pt;!function(t){t[t.GET=0]="GET",t[t.POST=1]="POST",t[t.HEAD=2]="HEAD",t[t.PUT=3]="PUT",t[t.DELETE=4]="DELETE"}(It||(It={}));class Ut{constructor(t,e=0,n=null){this.message=t,this.status=e,this.details=n}get isHttpError(){return!0}get isBadRequest(){return null!=this.status&&this.status>=400&&this.status<500}get isServerError(){return null!=this.status&&this.status>=500&&this.status<600}get isServiceUnavailable(){return 503===this.status}get isOverQuota(){return 429===this.status}}function Ht(t,e,n){return n=n||{},null==t||null==e?Promise.reject(new Ut("HTTP method or URL are not set")):null!=n.timeoutInMs&&n.timeoutInMs<0?Promise.reject(new Ut("Cannot have a negative timeout. Set to 0 to have no timeout")):new Promise(function(s,r){const o=new XMLHttpRequest;!function(t,e,n,s){if(s.query){const t=function(t){let e="",n=0;if(t)for(const s in t)n++&&(e+="&"),e+=encodeURIComponent(s),null!=t[s]&&(e+="="+encodeURIComponent(t[s]));return e}(s.query);t.length>0&&(e+=(e.indexOf("?")<0?"?":"&")+t)}if(s.timeoutInMs&&"number"===xt(s.timeoutInMs)&&(t.timeout=s.timeoutInMs),t.open(It[n],e,!0),s.headers)for(const e in s.headers)t.setRequestHeader(e,s.headers[e]);s.contentType&&t.setRequestHeader("Content-Type",s.contentType)}(o,e,t,n);let i=null;t!=It.GET&&t!=It.HEAD&&(i=n.body),o.send(i),o.onload=function(){if(o.status>=200&&o.status<300){let t=o.response;if(n.parser)try{t=n.parser(o)}catch(t){return h.debug(t),void r(t)}s(t)}else r(new Ut(o.statusText,o.status,o))},o.onerror=function(){const t=o.statusText||"Failed to send the request";r(new Ut(t,o.status,o))},o.ontimeout=function(){r(new Ut("Timed out",-1,o))}})}function Vt(t){kt=t}function Ft(t,e,n,s,r,o){function i(){Lt&&clearTimeout(Lt)}function a(t){i(),jt().then(()=>{o(t)})}Lt&&clearTimeout(Lt),n||(Lt=window.setTimeout(()=>{h.error("20000ms completed now. Translation timed out."),a(JSON.stringify({status:-2}))},2e4)),h.info("Beginning page translation..."),jt().then(()=>function(t,e,n,s,r,o){const i=t=>{h.debug("Intermidiate complete called with "+t),s&&s()},a=t=>{h.error("Error occurred while translating. Details: "+t),m(null),o&&o(t)};return d.translateServiceSubscriptionKey=kt,g.translationStartTime=performance.now(),new Promise(function(s){m(new wt(document.body,t,e,s,a,!1,n,i,r)),p.executeTranslation()}).then(function(){h.info("Successfully completed translation.")}).catch(function(t){h.error("Failed to translate the page",t),o&&o(t)})}(t,e,n,()=>{i(),s()},r,t=>{i(),o(t)})).catch(t=>{h.error("Failed to translate page."),a(t)})}function jt(){return null==p?Promise.resolve():new Promise(t=>{p?.cancel(),m(null),h.info("Successfully completed untranslation."),t()})}function qt(t){if(!t)return null;const e=t.getSelection();let n;const s=t.document.activeElement;if(s&&e&&s.nodeType===Node.ELEMENT_NODE&&"A"===s.nodeName&&!e.containsNode(s,!0))return n=t.document.createRange(),n.selectNode(s),e.removeAllRanges(),e.addRange(n),s;if(!e||e.isCollapsed||e.rangeCount<1)return null;n=e.getRangeAt(0);const r=n.startContainer,o=n.endContainer,i=n.startOffset;let a=n.endOffset;return r.nodeType===Node.TEXT_NODE&&0!==i&&r.parentNode&&r.nodeValue&&(r.parentNode.insertBefore(document.createTextNode(r.nodeValue.substring(0,i)),r),r.nodeValue=r.nodeValue.substring(i),n.setStart(r,0),r===o&&(a-=i)),o.nodeType===Node.TEXT_NODE&&o.nodeValue&&a!==o.nodeValue.length&&(o.parentNode?.insertBefore(document.createTextNode(o.nodeValue.substring(a)),o.nextSibling),o.nodeValue=o.nodeValue.substring(0,a),n.setEnd(o,o.nodeValue.length)),e.removeAllRanges(),e.addRange(n),n.commonAncestorContainer.nodeType===Node.TEXT_NODE?n.commonAncestorContainer.parentNode:n.commonAncestorContainer}function Bt(t,e,n,s){d.translateServiceSubscriptionKey=kt,g.translationStartTime=performance.now();const r=[];let o=qt(window);o&&r.push(o);const i=document.querySelectorAll("iframe");for(let t=0;t<i.length;t++)try{o=qt(i[t].contentWindow),o&&r.push(o)}catch{}const a=t=>{h.error("Error occurred while translating selection. Details: "+t),m(null),"function"==typeof s&&s(t)};function l(s){return new Promise(function(r,o){m(new wt(s,"",t,r,function(t){a(t),o(t)},!0,!1,e,n)),p.executeTranslation()})}let u=Promise.resolve(null);for(let t=0;t<r.length;t++)u=u.then(l.bind(null,r[t]));return u.catch(function(t){h.error("Failed to translate the text selection(s)",t),a(t),Promise.reject(t)})}class Jt extends Array{get top(){return this[this.length-1]}set top(t){this[this.length-1]=t}}function zt(){return p&&p.getAllDetectedLanguages()}function Gt(){return p&&p.getDetectedLanguage()}(function(t){t.startPageTranslation=Ft,t.startSelectionTranslation=Bt,t.stopPageTranslation=jt,t.setTranslateServiceSubscriptionKey=Vt,t.getAllDetectedLanguages=zt,t.getDetectedLanguage=Gt})(Pt||(Pt={})),Microsoft=s})()}catch(t){cr.googleTranslate.onTranslateElementError(t)}})();export{translate};
